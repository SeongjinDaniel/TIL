# Redis 장단점



## Redis의 장점

- 리스트, 배열과 같은 데이터를 처리하는데 유용하다.
  - value 값으로 여러 데이터 형식을 지원한다.
  - ( String, List, Set, Sorted set, Hash 등 )
  - 따라서 다양한 방식으로 데이터를 활용할 수 있다.
  - 리스트형 데이터 입력과 삭제는
  - MySQL에 비해서 *10배* 정도 빠르다고 한다.



- 메모리를 활용하면서 영속적인 데이터 보존이 가능하다.
  - 명령어로 명시적으로 삭제(Expires)를 설정하지 않으면
  - 데이터가 삭제되지 않는다.
  - **디스크에 데이터**를 **기록**하고 있기 때문에
  - Redis 메모리가 날라가도 데이터를 복구할 수 있다.
  - **스냅샷(기억장치)** 기능을 제공하여
  - 메모리의 내용을 *.rdb 파일로 저장하여 해당 시점으로 복구 할 수 있다.

> 주의할 점 : *.rdb

- 스냅샷을 남기는 확장자가 rdb이기 때문에
- DB의 모든 기능 역시 지원되지 않을까 생각할 수 있다.
- 하지만 단순히 이름만 **rdb**일 뿐
- 메모리 내용을 저장하는 기능 이외는 아무것도 지원하지 않는다.
- 이렇게 덤프한 내용은
- 다시 메모리에 올려 사용할 수 있다.
- (= **해당 시점**으로 복구 할 수 있다.)



- Redis Server는 1개의 **싱글 쓰레드**로 수행되며
- 따라서 서버 하나에 여러개의 서버를 띄우는 것이 가능하다.
  - **Master - Slave 형식**으로 구성이 가능하다.
  - **데이터 분실 위험**을 없애주는 것이 바로 위 Master - Slave 방식이다.
  - 위 기능을 이용하여
  - 실시간으로 데이터를 다른 서버에 복제한다.
  - Master Sserver가 Down 되어도
  - Slave Server로 접속하면 바로 서비스를 계속할 수 있다.



- Memcached 보다 **다양한 API**를 지원한다.
  - 아래의 경우에는 Redis API가 Memcached API보다 유용하다.
  - 여러개의 캐시를 한번에 업데이트해야하는 경우
  - Redis에서는 *mset* 이라는 함수를 사용하면 된다.
  - 그런데 Memcached에서는 여러개의 캐시 데이터를 가져오는건 가능하지만
  - 여러개의 캐시 데이터를 업데이트하는 API는 지원하지 않는다.
  - 많은 양의 캐시를 업데이트를 해줘야하는 상황에서
  - Memcached를 사용하면
  - 업데이트 해야하는 데이터 양만큼 set API를 호출해야 한다.
  - 반면 Redis에서는
  - 데이터의 크기를 쪼개서 mset을 호출하면
  - Memcached로 동작할 때 보다 빠른 시간안에 작업할 수 있다.

------

## Redis의 단점

- **메모리 파편화**가 발생하기 쉽다.
  - 메모리를 **2배**로 사용한다.
  - Redis는 **싱글 쓰레드**이다.
  - 그래서 스냅샷을 뜰 때
  - 자식 프로세스를 하나 만들낸 후
  - 새로 변경된 메모리 페이지를 복사해서 사용한다.
  - Redis는 **copy-on-write 방식**을 사용한다.
  - 보통 Redis를 사용할 때는 데이터 변경이 잦기 때문에
  - 실제 메모리 크기만큼 자식 프로세스가 복사하게 된다.
  - 그래서 실제로 필요한 메모리 양보다
  - **더 많은 메모리**를 사용하게 된다.



- 대규모 데이터에 대한 **응답 속도의 불안정성**
  - 대규모 트래픽으로 인해 많은 데이터가 업데이트되면
  - Redis는 Memcached에 비해서 속도가 불안정하다.
  - 이것은 Redis와 Memcached의 **메모리 할당 구조**가 다르기 때문에 발생하는 현상이다.
  - Redis는 jemalloc을 사용하기 때문에
  - 매번 malloc과 free를 통해서 **메모리 할당**이 이루어진다.
  - 반면 Memcached는
  - slab 할당자를 이용하여
  - 내부적으로는 메모리 재할당을 하지 않고 관리하는 형태를 취한다.
  - 이로 인해서 Redis는
  - **메모리 파편화**가 발생하며
  - 이 할당 비용 때문에 응답 속도가 느려진다.
  - 다만 이는 극단적으로 봤을 때 발생하는 일이다.
  - 대규모 서비스에서도 Redis를 많이 도입하는 것을 보면
  - 일반적으로 스타트업 등에서 사용하여도 무방하다 볼 수 있다.





#### 참조

- https://goodgid.github.io/Redis/