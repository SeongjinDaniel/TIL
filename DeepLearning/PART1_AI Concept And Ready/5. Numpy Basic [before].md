# Numpy 기초 [before]

## zeros & ones

0으로 채워진 numpy array를 만들 수 있음

In [3]:

```
zeros = np.zeros([3, 3])
zeros
```

Out[3]:

```
array([[0., 0., 0.],
       [0., 0., 0.],
       [0., 0., 0.]])
```

In [4]:

```
zeros = np.zeros(1)
zeros
```

Out[4]:

```
array([0.])
```

In [6]:

```
ones = np.ones([10, 5])
ones
```

Out[6]:

```
array([[1., 1., 1., 1., 1.],
       [1., 1., 1., 1., 1.],
       [1., 1., 1., 1., 1.],
       [1., 1., 1., 1., 1.],
       [1., 1., 1., 1., 1.],
       [1., 1., 1., 1., 1.],
       [1., 1., 1., 1., 1.],
       [1., 1., 1., 1., 1.],
       [1., 1., 1., 1., 1.],
       [1., 1., 1., 1., 1.]])
```

In [7]:

```
ones * 5
```

Out[7]:

```
array([[5., 5., 5., 5., 5.],
       [5., 5., 5., 5., 5.],
       [5., 5., 5., 5., 5.],
       [5., 5., 5., 5., 5.],
       [5., 5., 5., 5., 5.],
       [5., 5., 5., 5., 5.],
       [5., 5., 5., 5., 5.],
       [5., 5., 5., 5., 5.],
       [5., 5., 5., 5., 5.],
       [5., 5., 5., 5., 5.]])
```

In [8]:

```
arr = np.arange(5)
arr
```

Out[8]:

```
array([0, 1, 2, 3, 4])
```

In [10]:

```
arr = np.arange(4, 9)
arr
```

Out[10]:

```
array([4, 5, 6, 7, 8])
```

In [11]:

```
arr = np.arange(10, 20)
arr
```

Out[11]:

```
array([10, 11, 12, 13, 14, 15, 16, 17, 18, 19])
```

In [19]:

```
arr = np.arange(9).reshape(3, 3)
arr
```

Out[19]:

```
array([[0, 1, 2],
       [3, 4, 5],
       [6, 7, 8]])
```

In [21]:

```
arr[1][2]
```

Out[21]:

```
5
```

In [22]:

```
arr[1, 2]
```

Out[22]:

```
5
```

# Index

In [13]:

```
nums = [1, 2, 3, 4, 5]
```

In [15]:

```
nums[2:]
```

Out[15]:

```
[3, 4, 5]
```

In [17]:

```
nums = [1, 2, 3, 4, [1, 2, 3]]
nums
```

Out[17]:

```
[1, 2, 3, 4, [1, 2, 3]]
```

In [18]:

```
nums[4]
```

Out[18]:

```
[1, 2, 3]
```

# Slicing

In [23]:

```
arr
```

Out[23]:

```
array([[0, 1, 2],
       [3, 4, 5],
       [6, 7, 8]])
```

In [24]:

```
arr[1:]
```

Out[24]:

```
array([[3, 4, 5],
       [6, 7, 8]])
```

In [25]:

```
arr[1:, 1:]
```

Out[25]:

```
array([[4, 5],
       [7, 8]])
```

In [26]:

```
arr
```

Out[26]:

```
array([[0, 1, 2],
       [3, 4, 5],
       [6, 7, 8]])
```

## Boolean Indexing

In [28]:

```
data = np.random.randn(3, 3)
data
```

Out[28]:

```
array([[ 0.16667856,  1.28071998,  0.65536914],
       [ 2.02167048, -0.0095283 , -0.02454767],
       [-0.33350238, -0.46076299,  0.5744018 ]])
```

In [32]:

```
data[data <= 0] = 1
data
```

Out[32]:

```
array([[0.16667856, 1.28071998, 0.65536914],
       [2.02167048, 1.        , 1.        ],
       [1.        , 1.        , 0.5744018 ]])
```

# Broadcast

tensorflow나 pytorch로 계산하면 broadcast의 개념도 잘 이해해야 함

broadcast는 연산 하려는 서로 다른 두개의 행렬의 shape가 같지 않고,
한쪽의 차원이라도 같거나 또는 값의 갯수가 한 개 일 때
이를 여러 복사를 하여 연산을 함

In [33]:

```
import numpy as np
```

In [35]:

```
arr = np.arange(9).reshape(3, 3)
arr
```

Out[35]:

```
array([[0, 1, 2],
       [3, 4, 5],
       [6, 7, 8]])
```

In [37]:

```
arr + 3
```

Out[37]:

```
array([[ 3,  4,  5],
       [ 6,  7,  8],
       [ 9, 10, 11]])
```

In [38]:

```
arr * 3
```

Out[38]:

```
array([[ 0,  3,  6],
       [ 9, 12, 15],
       [18, 21, 24]])
```

In [39]:

```
arr
```

Out[39]:

```
array([[0, 1, 2],
       [3, 4, 5],
       [6, 7, 8]])
```

In [41]:

```
arr + np.array([1, 2, 3])
```

Out[41]:

```
array([[ 1,  3,  5],
       [ 4,  6,  8],
       [ 7,  9, 11]])
```

## Math Function

In [45]:

```
arr
```

Out[45]:

```
array([[0, 1, 2],
       [3, 4, 5],
       [6, 7, 8]])
```

In [42]:

```
arr + 10
```

Out[42]:

```
array([[10, 11, 12],
       [13, 14, 15],
       [16, 17, 18]])
```

In [43]:

```
arr * 5

```

Out[43]:

```
array([[ 0,  5, 10],
       [15, 20, 25],
       [30, 35, 40]])
```

In [44]:

```
arr + arr
```

Out[44]:

```
array([[ 0,  2,  4],
       [ 6,  8, 10],
       [12, 14, 16]])
```

In [47]:

```
np.add(arr, 1)
```

Out[47]:

```
array([[1, 2, 3],
       [4, 5, 6],
       [7, 8, 9]])
```

In [48]:

```
arr + 1
```

Out[48]:

```
array([[1, 2, 3],
       [4, 5, 6],
       [7, 8, 9]])
```

In [49]:

```
np.multiply(arr, 3)
```

Out[49]:

```
array([[ 0,  3,  6],
       [ 9, 12, 15],
       [18, 21, 24]])
```

In [50]:

```
arr = np.random.randint(2, size=27).reshape(3, 3, 3) # 0 ~ 2 전까지의 숫자를 만들고 그 사이즈는
arr_2 = np.random.randint(2, size=9).reshape(3, 3)
```

In [54]:

```
arr.shape, arr_2.shape
```

Out[54]:

```
((3, 3, 3), (3, 3))
```

In [57]:

```
arr
```

Out[57]:

```
array([[[1, 0, 1],
        [1, 0, 0],
        [0, 0, 1]],

       [[0, 1, 0],
        [0, 0, 1],
        [1, 0, 1]],

       [[0, 0, 0],
        [0, 0, 0],
        [0, 1, 0]]])
```

In [53]:

```
arr_2
```

Out[53]:

```
array([[1, 0, 0],
       [0, 1, 0],
       [1, 1, 0]])
```

In [56]:

```
arr + arr_2
```

Out[56]:

```
array([[[2, 0, 1],
        [1, 1, 0],
        [1, 1, 1]],

       [[1, 1, 0],
        [0, 1, 1],
        [2, 1, 1]],

       [[1, 0, 0],
        [0, 1, 0],
        [1, 2, 0]]])
```

In [58]:

```
arr * arr_2
```

Out[58]:

```
array([[[1, 0, 0],
        [0, 0, 0],
        [0, 0, 0]],

       [[0, 0, 0],
        [0, 0, 0],
        [1, 0, 0]],

       [[0, 0, 0],
        [0, 0, 0],
        [0, 1, 0]]])
```

In [59]:

```
np.sum(arr)
```

Out[59]:

```
9
```

In [60]:

```
np.sum(arr + arr_2)
```

Out[60]:

```
21
```

In [62]:

```
arr + arr_2
```

Out[62]:

```
array([[[2, 0, 1],
        [1, 1, 0],
        [1, 1, 1]],

       [[1, 1, 0],
        [0, 1, 1],
        [2, 1, 1]],

       [[1, 0, 0],
        [0, 1, 0],
        [1, 2, 0]]])
```

In [63]:

```
np.max(arr + arr_2)
```

Out[63]:

```
2
```

In [64]:

```
np.min(arr + arr_2)
```

Out[64]:

```
0
```

In [66]:

```
arr + arr_2
```

Out[66]:

```
array([[[2, 0, 1],
        [1, 1, 0],
        [1, 1, 1]],

       [[1, 1, 0],
        [0, 1, 1],
        [2, 1, 1]],

       [[1, 0, 0],
        [0, 1, 0],
        [1, 2, 0]]])
```

In [65]:

```
np.max(arr + arr_2)
```

Out[65]:

```
2
```

In [67]:

```
np.min(arr + arr_2)
```

Out[67]:

```
0
```

In [69]:

```
np.max(arr + arr_2, 0)
```

Out[69]:

```
array([[2, 1, 1],
       [1, 1, 1],
       [2, 2, 1]])
```

In [70]:

```
np.max(arr + arr_2, -1)
```

Out[70]:

```
array([[2, 1, 1],
       [1, 1, 2],
       [1, 1, 2]])
```

In [72]:

```
arr + arr_2
```

Out[72]:

```
array([[[2, 0, 1],
        [1, 1, 0],
        [1, 1, 1]],

       [[1, 1, 0],
        [0, 1, 1],
        [2, 1, 1]],

       [[1, 0, 0],
        [0, 1, 0],
        [1, 2, 0]]])
```

In [73]:

```
np.sum(arr + arr_2, axis=-1)
```

Out[73]:

```
array([[3, 2, 3],
       [2, 2, 4],
       [1, 1, 3]])
```

In [74]:

```
np.sum(arr + arr_2, -1)
```

Out[74]:

```
array([[3, 2, 3],
       [2, 2, 4],
       [1, 1, 3]])
```

In [75]:

```
np.mean(arr)
```

Out[75]:

```
0.3333333333333333
```

In [80]:

```
arr = np.array([1, 6, 3, 7, 3, 2, 9, 0, 2])
arr
```

Out[80]:

```
array([1, 6, 3, 7, 3, 2, 9, 0, 2])
```

In [81]:

```
np.argmax(arr) # 제일 큰 인덱스 반환
```

Out[81]:

```
6
```

In [82]:

```
np.argmin(arr)
```

Out[82]:

```
7
```

In [83]:

```
arr = np.array([3, 5, 6, 6, 3, 3, 1])
```

In [84]:

```
np.unique(arr)
```

Out[84]:

```
array([1, 3, 5, 6])
```

----------

## data type

array의 dtype을 본다.

In [144]:

```
arr = np.array([[1, 2, 3],[1, 2, 3]])
```

In [145]:

```
arr.dtype
```

Out[145]:

```
dtype('int32')
```

.astype()으로 datatype을 변환 가능

In [146]:

```
arr = arr.astype(np.int32)
arr
```

Out[146]:

```
array([[1, 2, 3],
       [1, 2, 3]])
```

In [147]:

```
arr = np.array([[1, 2, 3],[1, 2, 3]], dtype=np.uint8)
arr.dtype
```

Out[147]:

```
dtype('uint8')
```

len(arr.shape) 를 통해서 차원의 갯수를 확인 할 수 있지만,
아래와 같이 ndim을 통해 차원 수를 return 가능

In [148]:

```
len(arr.shape)
```

Out[148]:

```
2
```

In [149]:

```
arr.shape
```

Out[149]:

```
(2, 3)
```

size 확인

In [150]:

```
arr.size
```

Out[150]:

```
6
```

dtype 확인

In [151]:

```
arr.dtype
```

Out[151]:

```
dtype('uint8')
```

## Reshape

In [152]:

```
arr.shape
```

Out[152]:

```
(2, 3)
```

Reshape

In [143]:

```
arr
```

Out[143]:

```
array([[1, 2, 3, 1, 2, 3]], dtype=uint8)
```

In [153]:

```
arr = arr.reshape([1, 6]) # 사이즈는 유지하되 dimension만 변경 가능하다.
arr.shape
arr
```

Out[153]:

```
array([[1, 2, 3, 1, 2, 3]], dtype=uint8)
```

In [156]:

```
arr = np.array([[1, 2, 3], [1, 2, 3]])
```

In [157]:

```
arr.reshape([6]).shape
```

Out[157]:

```
(6,)
```

Reshape, -1 활용

In [118]:

```
arr = arr.reshape(-1)
arr.shape
```

Out[118]:

```
(6,)
```

In [167]:

```
arr = arr.reshape(1, -1)
arr.shape
arr
```

Out[167]:

```
array([[ 0.67676843,  0.03019415, -1.46154914,  0.06852326, -0.18378676,
        -0.65225682,  1.27778661, -0.57285275, -0.77707567, -0.8826551 ,
        -0.47939266,  0.8089633 ,  0.48129382,  0.29037093,  1.20269584,
         0.0413061 ,  0.17457751,  0.78800428, -0.30006044, -1.31150972,
         0.2160474 , -0.7329307 ,  1.18621916, -1.59656839,  1.20242726,
         1.22248774,  0.68271405,  2.75834416, -0.25577388,  1.08720749,
        -1.20179286, -0.1774354 ,  0.23309517,  0.6202167 , -0.02306893,
         1.16767063,  1.29483292,  0.01615816, -1.00148251,  0.35052015,
        -1.58254068, -1.54231064, -1.90896307,  3.32132082,  1.452174  ,
         1.34157607,  1.84116328,  0.90036857,  1.89529853,  0.62873093,
         0.03198545,  0.98498632,  0.77971644, -0.19870117, -1.5821176 ,
        -0.02539026,  1.37453816, -0.89363211, -1.4443904 ,  0.49972344,
        -0.28122354,  1.61682039,  0.2559683 , -0.54313878]])
```

random array 생성

In [160]:

```
arr = np.random.randn(8, 8)
arr.shape
```

Out[160]:

```
(8, 8)
```

In [162]:

```
arr = arr.reshape([32, 2])
arr.shape
```

Out[162]:

```
(32, 2)
```

3차원으로 늘리기

In [174]:

```
arr = arr.reshape(-1, 2, 1, 1, 1, 1)
arr.shape
```

Out[174]:

```
(32, 2, 1, 1, 1, 1)
```

## Ravel

arr의 차원을 1로 바꿔줌
나중에 배울 layer를 flatten 할 때 같은 기능이라 생각하면 됨

In [175]:

```
arr.shape
```

Out[175]:

```
(32, 2, 1, 1, 1, 1)
```

In [176]:

```
arr = arr.ravel()
arr.shape
```

Out[176]:

```
(64,)
```

arr.reshape(-1) 와 같음

In [178]:

```
arr.ravel() == arr.reshape(-1)
```

Out[178]:

```
array([ True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True])
```

## np.expand_dims()

안의 값은 유지하되 차원 수를 늘리고 싶을 때가 있음
이럴 때 사용하는 것이 expand_dims

In [180]:

```
arr.shape
```

Out[180]:

```
(64,)
```

In [182]:

```
arr = np.expand_dims(arr, -1)
arr.shape
```

Out[182]:

```
(1, 64, 1)
```

In [197]:

```
arr = arr.ravel()
```

In [198]:

```
arr.shape
```

Out[198]:

```
(64,)
```

In [199]:

```
arr = np.expand_dims(arr, -1)
arr.shape
```

Out[199]:

```
(64, 1)
```

In [200]:

```
arr = np.expand_dims(np.expand_dims(arr, -1), 0)
```

In [201]:

```
arr.shape
```

Out[201]:

```
(1, 64, 1, 1)
```

