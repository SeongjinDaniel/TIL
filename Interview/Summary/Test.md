# Test



1. 시스템에 에러나 예외가 발생했을 때 Test를 작성해 두었으면 빠르게 확인 할 수 있으므로 **유지 보수성**에 좋다.
2. 테스트를 하지 않으면 내가 테스트 해야하지 생각만 하고 잊을 수 있지만 테스트 케이스를 만들어서 테스트한다면 **모든 테스트를 잊지 않고 만들어 확인**할 수 있다.
3. 여러가지 테스트를 버튼 하나로 테스트하니까 **생산성**이 좋아진다.
4. 내가 짠 코드들이 정상적으로 동작하는 것을 확인하 니까 **안심하고 리팩토링** 할 수 있다.

---



- **유닛 테스트:** 함수 하나하나와 같이 코드의 작은 부분을 테스트하는 것
- **통합 테스트:** 서로 다른 시스템들의 상호작용이 잘 이루어 지는지 테스트하는 것
- **기능 테스트:** 사용자와 어플리케이션의 상호작용이 원활하게 이루어지는지 테스트하는 것



#### 단위 테스트

**가장 작은 기능 단위, 일반적으로 메소드 / 함수를 테스트한다** (예 : 특정 상태의 클래스가 주어지면 클래스에서 x 메소드를 호출하면 y가 발생 함). 단위 테스트는 하나의 특정 기능에 중점을 두어야한다 (예 : 스택이 비어있을 때 pop 메소드를 호출하면 `InvalidOperationException`). 접촉하는 모든 것은 메모리에서 수행되어야한다. 즉, 테스트 코드와 테스트중인 코드는 다음과 같아서는 안된다.

- (사소하지 않은) 공동 작업자에게 전화
- 네트워크에 액세스 
- 데이터베이스 조회
- 파일 시스템 사용
- 실을 돌려
- 기타



느리거나 이해하기 어려운 / 초기화 / 조작하는 모든 종류의 의존성은 적절한 기술을 사용하여 스텁 / 모의 / 무엇을해야하는지에 따라 의존성이하는 것이 아니라 코드 단위가하는 일에 집중할 수 있다. 

간단히 말해, 단위 테스트는 가능한 한 간단하고 디버깅하기 쉽고 신뢰할 수 있으며 (외부 요소 감소로 인해) 실행 속도가 빠르고 프로그램의 가장 작은 빌딩 블록이 조합되기 전에 의도 한대로 작동 함을 증명하는 데 도움이된다. 주의해야 할 점은, 격리 된 상태에서 완벽하게 작동한다는 것을 증명할 수 있지만 코드 단위가 결합되면 폭발 할 수 있다.



#### 통합 테스트

**통합 테스트는 코드 단위를 결합하고 결과 조합이 올바르게 작동하는지 테스트하여 단위 테스트를 기반으로한다.** 하나의 시스템에 내장되어 있거나 여러 시스템을 결합하여 유용한 기능을 수행 할 수 있다. 또한 통합 테스트와 단위 테스트를 차별화하는 또 다른 사항은 환경이다. **통합 테스트는 스레드를 사용하거나 데이터베이스에 액세스하거나 모든 코드와 다른 환경 변경이 올바르게 작동하는지 확인하는 데 필요한 모든 작업을 수행 할 수 있다.**

직렬화 코드를 구축하고 디스크를 건드리지 않고 내장을 테스트 한 경우 디스크를 로드하고 디스크에 저장할 때 어떻게 작동하는지 어떻게 알 수 있습니까? 파일 스트림을 플러시하고 처리하는 것을 잊었을 수 있습니다. 파일 권한이 잘못되었을 수 있으며 메모리 스트림에서 사용하여 내장을 테스트했습니다. 확실하게 확인할 수있는 유일한 방법은 프로덕션에 가장 가까운 환경을 사용하여 '실제'테스트하는 것입니다.

---



#### 단위 테스트 (Unit Test)

**개발 단계에서 각 모듈이 개발 완료되는 시점에서 단위 테스트를 시행한다.**

모듈이라 하면, 어렵게 생각하실 거 없다. 일종의 프로그램 내의 하나의 기능으로 생각하시면 쉬울 것 같다. MS Word라는 프로그램이 있다는 가정하에 Word 내에 있는 기능 중, 폰트 사이즈 선택 기능이 일종에 모듈이라 본다. 다시 말해 모듈을 테스트한다는 의미는 하나의 기능만이 잘 동작하는지를 확인하는 과정이다. 다른 말로는 모듈 테스트(Module Test)라고도 한다. 모듈이 개발 완료되는 시점에서 개발자가 명세서 기반으로 정확히 개발을 하였는지를 테스트하게 된다. 단위 테스트에서는 화이트박스 테스트, 블랙박스 테스트 기법을 모두 이용하여 진행할 수 있지만, 내부 구조를 들여다볼 수 있는 화이트박스 테스트 기법을 주로 이용하여 테스트를 진행하게 된다.



본론으로 들어와서 테스트하려는 모듈을 실행하려면 해당 모듈을 실행할 수 있는 환경 구성이 필요하다. 다시 말해 테스트할 모듈을 호출하여 실행하는 모듈이 있을 수 있으며, 반대로 테스트하려는 모듈이 다른 모듈을 호출하여 실행하는 경우도 있을 수 있다. 즉 테스트하려는 모듈을 실행하려면 앞서 말한 2가지 경우의 수의 모듈이 모두 존재해야 정확한 테스트가 가능하다. 하지만 상위 모듈이나 하위 모듈이 100% 존재한다는 보장이 없기 때문에 아래와 같은 가상의 모듈을 만들어 사용해야 한다.



**테스트 드라이버 (Test Driver):** 테스트 대상이 되는 모듈을 호출하여 대상 모듈의 실행 결과는 받는 가상 모듈

**테스트 스텁 (Test Stub):** 호출하는 상황의 대상 모듈을 테스트하기 위한 가상 모듈



다시 정리하면 테스트 드라이버는 테스트 대상이 되는 모듈의, 상위 가상 모듈로 생각하시면 쉽게 이해가 가실 거 같고, 반대로 테스트 스텁은 테스트 대상이 되는 모듈의, 하위 가상 모듈이다.





#### 통합 테스트 (Integration Test)

**모듈을 통합하는 과정에서 모듈 간 호환성의 문제를 찾아내기 위해 수행되는 테스트이다.**

다시 말에 모듈 간의 인터페이스가 올바르게 작동하는지를 테스트하게 된다. 예를 들어 다시 MS Word라는 프로그램 내에 ‘폰트 사이즈’ 모듈과 ‘폰트 스타일’ 모듈을 통합한다는 가정을 해본다. 이때 만약 ‘폰트 스타일’ 모듈 구현 당시 폰트 사이즈가 변화할 수 있다는 것을 인지하지 않고 개발을 하게 된다면 폰트 사이즈 모듈과 통합되는 과정에서 에러가 발생할 수 있다. 이를테면 기본 폰트 사이즈 9pt에서만 폰트 스타일이 먹히는 문제? 일수 있겠다.

다시 정리하면 각각의 통합한 모듈이 올바르게 연계되어서 동작하는지를 테스트하게 됀다.



모듈 테스트 시 통합 기법으로는 크게 빅뱅 통합과 점진적 통합 기법이 있다.



빅뱅 통합: 전체 모듈을 모두 통합한 이후 통합 테스트를 수행하는 방식 이때 오류가 발생했을 시 오류가 발생한 모듈을 찾기가 쉽지 않다는 단점이 있다.

점진적 통합: 한 번에 모듈을 통합하지 않고 점진적으로 통합하는 방식으로 하향식 통합, 상향식 통합 기법이 대표적이다. 점진적 통합 기법을 이용하게 되면 설계상의 오류를 빨리 발견할 수 있다는 장점이 있다.

---



#### 단위 테스트(Unit Test)

유닛 테스트는 전체 코드 중 **작은 부분**을 테스트하는 것이다. (예를 들어, 함수 하나하나 개별로 테스트 코드를 작성하는 것) 만약 테스트에 네트워크나 데이터베이스 같은 외부 리소스가 포함된다면 그것은 유닛 테스트가 아니다.

 

또한, 유닛 테스트는 매우 간단하고 명확하여야 한다.

기본적으로 테스트를 위한 입력 값을 주어서 그에 대한 함수의 출력 값이 정확 한지 아닌지를 판단하는 것이 유닛 테스트라 할 수 있다.

코드의 설계가 별로 좋지 못하다면 유닛 테스트를 작성하기도 어려워진다.

따라서 함수(메소드) 하나하나 테스트 코드를 작성하는 유닛 테스트는 좀 더 나은 코드를 만들 수 있도록 도와준다.

 

비유하자면, 유닛 테스트는 척추에 비유할 수 있다.

유닛 테스트를 사용한다면 좋은 코드를 디자인할 수 있을 뿐만 아니라 어떤 함수(메소드)에 변화가 생겼을 때 그 함수가 안전하게 수행되는지를 보장해주고 같은 함수(메소드)를 다른 종류의 테스트에서도 적용하기 쉽게 만들어 준다.

유닛 테스트는 빈번히 일어나는 버그를 막는데도 뛰어난 역할을 한다.

코드 일부분에 문제가 있을 경우 아무리 많이 문제 있는 부분을 수정하려 해도 수정한 부분의 코드가 또 문제를 일으키고.. 문제가 문제를 낳는 경우가 대부분이다.

이럴 때 버그가 있는지 없는지 체크하는 유닛 테스트를 만들어 둠으로써 이러한 문제를 쉽게 해결할 수 있다.



통합 테스트(Integration Teset), 기능 테스트(Functional Teset)는 이벤트의 흐름에 이상이 없는지 테스팅하는데 좋은 반면, 유닛 테스트는 어떠한 부분에 문제가 있고 고칠 부분이 어디인지 명확하게 해 줄 때 좋다.

 

정리하자면, 테스트 중심 개발(test-driven development) 일 때 유닛 테스트는 꼭 작성해야 하며, 코드의 디자인을 개선해주고 나중에 코드의 리팩토링이 필요할 때 어떤 부분을 완전히 분리할 필요 없이 깔끔하게 해 준다.



#### 통합 테스트(Integration Test)

통합 테스트는 이름에서 의미하는 바와 같이 각각의 시스템들이 서로 어떻게 상호작용하고 제대로 작동하는지 테스트하는 것을 의미한다.

통합 테스트는 유닛 테스트와 비슷한데, 큰 차이점이 하나 있다. 유닛 테스트는 다른 컴포넌트들과 독립적인 반면 통합 테스트는 그렇지 않다.

예를 들자면 유닛 테스트에서 데이터베이스에 접근하는 코드는 실제 데이터 베이스와 통신하는 것은 아니지만, 통합 테스트는 실제 통신해야 한다.

 

통합 테스트는 유닛 테스트만으로 충분하다고 느끼지 못할 때 사용된다.

때때로 두 개의 다른 분리된 시스템끼리 잘 통신하고 있는지 증명하고 싶을 때가 있는데(예를 들어 나의 앱과 데이터 베이스가 제대로 상호작용하고 있는지...) 이것을 통합 테스트라 한다.

통합 테스트는 대게 유닛 테스트를 작성하는 것보다 복잡하고 오랜 시간이 걸린다. (데이터베이스를 세팅할 때, 설정 파일을 읽어 오는 과정이라던가 데이터베이스가 잘 세팅되었는지 확인하는 과정이라던가)

따라서 통합 테스트가 꼭 필요한 것이 아니면 유닛 테스트를 작성하는데 집중하는 것이 좋다.



#### 기능 테스트(Functional Test)

기능 테스트는 E2E 테스트(E2E Test) 혹은 브라우저 테스트(Browser Test)라고 불리며 모두 같은 의미다.

 

기능 테스트는 어떤 어플리케이션이 제대로 동작하는지 완전한 기능을 테스트하는 것을 의미한다.

예를 들어, 어떤 웹 어플리케이션을 기능 테스트한다고 가정해보면 브라우저 자동화 도구를 사용해 특정한 페이지를 클릭한다던가 하는 것이 기능 테스트라 할 수 있다.

 

유닛 테스트를 사용하여 개별의 함수가 제대로 동작하는지 확인하고 통합 테스트를 통해 서로 다른 시스템이 잘 상호작용 하는지 확인할 수 있다.

기능 테스트는 이와 완전히 다른 레벨에 있다고 생각하면 된다.

유닛 테스트는 수백 가지가 있을 수 있지만 기능 테스트는 그렇지 못하다.

기능테스트는 작성하기 매우 어렵고 높은 복잡성을 가지고 있기 때문에 많은 시간이 걸린다. (웹 어플리케이션을 가정하면 기능 테스트는 실제 사용자 상호 작용을 시뮬레이션하므로 페이지 로딩 시간조차도 기능 테스트의 한 요인이 된다)

 

위와 같은 이유로 기능 테스트를 매우 세밀하게 나눠서 하면 좋지 못하다.

대신 기능 테스트는 사용자와 앱의 상호작용을 테스트하고 싶을 때 유용하다. (예를 들어, 회원 가입과 같이 브라우저에서 앱의 특정 흐름을 수동으로 테스트하는 경우)

회원 가입에 대한 기능 테스트라 하면 유저가 회원가입을 마치고 "저희 사이트에 회원 가입하게 된 것을 축하드립니다."라는 페이지를 올바르게 출력해줄 것을 보장해주어야 한다.

#### 참조

- [단위, 기능, 수용 및 통합 테스트의 차이점은 무엇입니까?](https://c10106.tistory.com/3339)

- [단위 테스트, 통합 테스트 란?](https://osb0728.tistory.com/26)
- [[Test\] 유닛 테스트(Unit Test), 통합 테스트(Integration Test), 기능 테스트(Functional Test)란?](https://cjwoov.tistory.com/9)

- [[tdd] 인수테스트, 단위테스트, 통합테스트, 전 구간 테스트](https://joont92.github.io/tdd/%EC%9D%B8%EC%88%98%ED%85%8C%EC%8A%A4%ED%8A%B8-%EB%8B%A8%EC%9C%84%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%86%B5%ED%95%A9%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%A0%84-%EA%B5%AC%EA%B0%84-%ED%85%8C%EC%8A%A4%ED%8A%B8/)